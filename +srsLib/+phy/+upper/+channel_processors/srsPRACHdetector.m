%srsPRACHdetector Detects the 5G NR PRACH preamble in a PRACH occasion.
%   [INDICES, OFFSETS, NMETRIC, RSSI] = srsPRACHdetector(CARRIER, PRACH, GRID, IGNORECFO)
%   detects the 5G NR PRACH preambles in GRID. GRID is a matrix (one column per
%   RX antenna port) with the baseband symbols corresponding to one PRACH occasion,
%   that is it may contain a number of copies of the preamble depending on the
%   format. CARRIER is an nrCarrierConfig object with the carrier configuration.
%   PRACH is an nrPRACHConfig object with the PRACH configuration (the
%   PreambleIndex field is ignored). The boolean flag IGNORECFO tells the detector
%   whether to assume that the signal is affected by CFO (false) or not (true).
%
%   The function returns INDICES and OFFSETS, that is a 64-entry boolean mask of
%   the detected Preamble indices and the corresponding offsets in microseconds,
%   respectively. It also returns the valuse of the detecion metric (normalized
%   with respect to the detection threshold) and the signal RSSI (in dB).

%   Copyright 2021-2024 Software Radio Systems Limited
%
%   This file is part of srsRAN-matlab.
%
%   srsRAN-matlab is free software: you can redistribute it and/or
%   modify it under the terms of the BSD 2-Clause License.
%
%   srsRAN-matlab is distributed in the hope that it will be useful,
%   but WITHOUT ANY WARRANTY; without even the implied warranty of
%   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
%   BSD 2-Clause License for more details.
%
%   A copy of the BSD 2-Clause License can be found in the LICENSE
%   file in the top-level directory of this distribution.

function [indices, offsets, normMetric, rssi] = srsPRACHdetector(carrier, prachConf, grid, ignoreCFO, newThreshold)
    assert(prachConf.RestrictedSet == "UnrestrictedSet", "srsran_matlab:srsPRACHdetector",...
        "Only unrestricted sets are supported.");

    % Working copy of the PRACH configuration.
    prach = prachConf;
    % Reset the preamble index, since it is unkown.
    prach.PreambleIndex = 0;

    % Get the numerology index.
    mu = log2(carrier.SubcarrierSpacing / 15);

    % Get useful information about the PRACH preambles.
    info = getWindowInfo(prach, mu);

    LRA = prach.LRA;
    halfLRA = (LRA - 1) / 2;

    % Rearrange signal to have a single replica per column. If "ignoreCFO", the
    % replicas from the same antennas are combined together.
    preambles = preprocess(grid, LRA, ignoreCFO);

    nAntennas = size(grid, 2);
    nReplicas = size(preambles, 2);

    % Set the margin around the detection window (useful for computing reference
    % power).
    % Detection threshold. The detector is inspired by the GLRT test, but it's
    % not exactly that one - threshold must be tuned by simulation.
    [winMargin, threshold] = getThreshold(prach, nAntennas, carrier.SubcarrierSpacing, ignoreCFO);

    if ((nargin == 5) && isfinite(newThreshold))
        threshold = newThreshold;
    end

    Nfft = fftsize(prach.Format);

    % Initialize output.
    indices = false(64, 1);
    offsets = nan(64, 1);
    normMetric = nan(64, 1);

    rssi = 10 * log10(mean(abs(grid).^2, 'all') / LRA);

    nSequences = info.nSequences;
    remainingShifts = 64;
    for iSequence = 1:nSequences
        % Preamble index corresponding to the current sequence index.
        prach.PreambleIndex = (iSequence - 1) * info.nShifts;

        % Get the root sequence: note that MATLAB can return multiple copies
        % depending on the format.
        rootLong = nrPRACH(carrier, prach);
        root = rootLong(1:LRA);

        % Multiply the preamble by the complex conjugate of the root sequence and
        % take the ifft - same as correlation.
        noRoot = conj(root) .* preambles / LRA;
        % We want a symmetric FFT.
        noRootLarge = [noRoot(halfLRA + 1:end, :); zeros(Nfft - LRA, nReplicas); noRoot(1:halfLRA, :)];

        noRootTimeSimple = ifft(noRootLarge) * sqrt(Nfft);
        modSquare = abs(noRootTimeSimple).^2;

        noRootTimeSinc = noRootTimeSimple * sqrt(Nfft / LRA);

        nWindows = min(info.nShifts, remainingShifts);
        remainingShifts = remainingShifts - info.nShifts;
        assert((remainingShifts > 0) || (iSequence == nSequences));

        for iWindow = 1:nWindows
            % Scale the detection window according to the FFT size.
            winWidth = floor(info.WinWidths(iWindow) * Nfft / LRA);
            winStart = mod(Nfft - floor(info.WinStart(iWindow) * Nfft / LRA), Nfft);

            ix = (winStart - winMargin):(winStart + winWidth + winMargin - 1);

            winScalar = abs(noRootTimeSinc(winStart + (1:winWidth), :)).^2;

            % GLRT inspired detection test.
            reference = sum(modSquare(mod(ix, Nfft) + 1, :), 1);

            % The absolute value at the denominator shouldn't be necessary.
            % Nevertheless, because of the approximations, it may happen that
            % the difference at the denominator takes very small negative values.
            metricGlobal = sum(winScalar, 2) ./ abs(sum(reference - winScalar, 2));

            if false
                figure(1) %#ok<UNRCH>
                plot(winStart + (0:winWidth-1), winScalar);
                hold on
                plot(ix, abs(noRootTimeSimple(mod(ix, Nfft) +1, :)));
                hold off
                title(sprintf('%d', (iSequence-1) * info.nShifts + iWindow-1));

                metric = winScalar ./ abs(reference - winScalar);
                figure(2)
                hold off
                plot(winStart + (0:winWidth-1), [metric metricGlobal]);
                hold on
                plot(winStart + (0:winWidth-1), threshold*ones(winWidth,1), '-.');
                title(sprintf('%d', (iSequence-1) * info.nShifts + iWindow-1));
                pause(0.5)
            end

            % We don't want peaks at the very end of the window because they
            % are most probably side effects of a peak at the beginning of
            % the adjacent window. We discard peaks that fall in the last
            % 1/5 of the detection window.
            [m, delay] = max(metricGlobal);
            if (m > threshold) && (delay < length(metricGlobal) * 0.8)
                pos = (iSequence - 1) * info.nShifts + iWindow;
                indices(pos) = true;
                d = delay + winStart - 1;
                offsets(pos) = (d / Nfft - mod(LRA - info.WinStart(iWindow), LRA) / LRA) / prach.SubcarrierSpacing * 1000;
                normMetric(pos) = m / threshold;
            end
        end
    end

end

function ncs = getNCS(prach)
% Returns the NCS for the current prach configuration.
    switch prach.Format
        case {'0','1','2'}
            ncsTable = nrPRACHConfig.Tables.NCSFormat012;
            colName = prach.RestrictedSet;
        case '3'
            ncsTable = nrPRACHConfig.Tables.NCSFormat3;
            colName = prach.RestrictedSet;
        otherwise
            ncsTable = nrPRACHConfig.Tables.NCSFormatABC;
            colName = string(['LRA_' num2str(prach.LRA)]);
    end

    ncsRow = ncsTable(ncsTable{:, "ZeroCorrelationZone"} == prach.ZeroCorrelationZone, :);
    ncs = ncsRow.(colName);

    assert(isfinite(ncs), "srsran_matlab:srsPRACHdetector", ...
        "Invalid PRACH format, restricted set, ZCZ combination.");
end

function Ncp = getCP(prach)
% Returns the length of the cyclic prefix and of the preamble for the configured
% prach (an nrPRACHConfig object).
    switch prach.Format
        case {'0','1','2','3'}
            table = nrPRACHConfig.Tables.LongPreambleFormats;
        otherwise
            table = nrPRACHConfig.Tables.ShortPreambleFormats;
    end

    row = table(strcmp(table{:, "Format"}, prach.Format), :);
    Ncp = row.('N_CP');
    % Nu = row.('N_u');
end

function info = getWindowInfo(prach, mu)
% Returns a struct of useful information about the prach (an nrPRACHConfig object),
% assuming that the underlying PUSCH numerology is mu.

    % Only works for unrestricted sets.
    NCS = getNCS(prach);
    % Get the number of preambles using the same root sequence (i.e., the number
    % of cyclic shifts) and the total number of root sequences needed.
    if NCS == 0
        nShifts = 1;
        nSequences = 64;
    else
        nShifts = floor(prach.LRA / NCS);
        nSequences = ceil(64 / nShifts);
    end

    muLoc = mu;
    if prach.LRA == 839
        muLoc = 0;
    end

    % Get the length of the cyclic prefix, as given in the standard.
    CP = getCP(prach);

    % CP is in units of kappa * 2^(-muLoc), convert it to ms.
    CPms = CP * 64 / (2^muLoc * 480 * 4096);

    % Express the CP as a number of samples at sampling frequency equal to LRA * SCS.
    CPprach = floor(CPms * prach.LRA * prach.SubcarrierSpacing);

    % Each preamble correspond to a detection window whose width is the miniumum
    % between the CP length and the NCS.
    winWidth = min(NCS, CPprach);
    if NCS == 0
        winWidth = CPprach;
    end

    info.NCS = NCS;
    info.WinWidths = ones(nShifts, 1) * winWidth;
    info.WinStart = (0:(nShifts - 1)) * NCS;
    info.nSequences = nSequences;
    info.nShifts = nShifts;
end

function preambles = preprocess(grid, LRA, ignoreCFO)
% If the grid contains multiple replicas of the preamble (that is, for all formats
% but Format 0 and Format C0), reorganize samples so that we have one replica per
% column. If "ignoreCFO" replicas from the same antenna are averaged together.

    assert(mod(size(grid, 1), LRA) == 0, 'srsran_matlab:srsPRACHdetector', ...
        'The number of symbols does not match with the preamble length.');

    nAntennas = size(grid, 2);
    if ignoreCFO
        preambles = squeeze(mean(reshape(grid, LRA, [], nAntennas), 2));
        return;
    end

    preambles = reshape(grid, LRA, []);
end

function x = fftsize(format)
% FFT size used by the detector - it defines the offset granularity depending on
% the format.
    switch format
        case {'0', '1', '2', '3'}
            x = 1024;
        case {'A1', 'A2', 'A3', 'B1', 'B2', 'B3', 'B4', 'C0', 'C2'}
            x = 256;
        otherwise
            error('srsran_matlab:srsPRACHdetector', ...
                'Currently, Format %s is not supported.', format);
    end
end

% Returns the window margin and the detection threshold for the given PRACH configuration,
% number of antennas, subcarrier spacing, and CFO flag.
function [winMargin, threshold] = getThreshold(prach, nAntennas, scs, ignoreCFO)
    % assert(nAntennas <= 2, 'srsran_matlab:srsPRACHdetector', 'Only 2 antennas supported at the moment.');

    Configurations = [ ...
        "Ant1_SCS15_F0_NCS0_noCFO1", ...
        "Ant1_SCS15_F0_NCS13_noCFO1", ...
        "Ant1_SCS15_F0_NCS15_noCFO1", ...
        "Ant1_SCS15_F0_NCS18_noCFO1", ...
        "Ant1_SCS15_F0_NCS22_noCFO1", ...
        "Ant1_SCS15_F0_NCS26_noCFO1", ...
        "Ant1_SCS15_F0_NCS32_noCFO1", ...
        "Ant1_SCS15_F0_NCS38_noCFO1", ...
        "Ant1_SCS15_F0_NCS46_noCFO1", ...
        "Ant1_SCS15_F0_NCS59_noCFO1", ...
        "Ant1_SCS15_F0_NCS76_noCFO1", ...
        "Ant1_SCS15_F0_NCS93_noCFO1", ...
        "Ant1_SCS15_F0_NCS119_noCFO1", ...
        "Ant1_SCS15_F0_NCS167_noCFO1", ...
        "Ant1_SCS15_F0_NCS279_noCFO1", ...
        "Ant1_SCS15_F0_NCS419_noCFO1", ...
        "Ant2_SCS15_F0_NCS0_noCFO1", ...
        "Ant2_SCS15_F0_NCS13_noCFO1", ...
        "Ant2_SCS15_F0_NCS15_noCFO1", ...
        "Ant2_SCS15_F0_NCS18_noCFO1", ...
        "Ant2_SCS15_F0_NCS22_noCFO1", ...
        "Ant2_SCS15_F0_NCS26_noCFO1", ...
        "Ant2_SCS15_F0_NCS32_noCFO1", ...
        "Ant2_SCS15_F0_NCS38_noCFO1", ...
        "Ant2_SCS15_F0_NCS46_noCFO1", ...
        "Ant2_SCS15_F0_NCS59_noCFO1", ...
        "Ant2_SCS15_F0_NCS76_noCFO1", ...
        "Ant2_SCS15_F0_NCS93_noCFO1", ...
        "Ant2_SCS15_F0_NCS119_noCFO1", ...
        "Ant2_SCS15_F0_NCS167_noCFO1", ...
        "Ant2_SCS15_F0_NCS279_noCFO1", ...
        "Ant2_SCS15_F0_NCS419_noCFO1", ...
        "Ant4_SCS15_F0_NCS0_noCFO1", ...
        "Ant4_SCS15_F0_NCS13_noCFO1", ...
        "Ant4_SCS15_F0_NCS15_noCFO1", ...
        "Ant4_SCS15_F0_NCS18_noCFO1", ...
        "Ant4_SCS15_F0_NCS22_noCFO1", ...
        "Ant4_SCS15_F0_NCS26_noCFO1", ...
        "Ant4_SCS15_F0_NCS32_noCFO1", ...
        "Ant4_SCS15_F0_NCS38_noCFO1", ...
        "Ant4_SCS15_F0_NCS46_noCFO1", ...
        "Ant4_SCS15_F0_NCS59_noCFO1", ...
        "Ant4_SCS15_F0_NCS76_noCFO1", ...
        "Ant4_SCS15_F0_NCS93_noCFO1", ...
        "Ant4_SCS15_F0_NCS119_noCFO1", ...
        "Ant4_SCS15_F0_NCS167_noCFO1", ...
        "Ant4_SCS15_F0_NCS279_noCFO1", ...
        "Ant4_SCS15_F0_NCS419_noCFO1", ...
        "Ant1_SCS15_F1_NCS0_noCFO1", ...
        "Ant1_SCS15_F1_NCS13_noCFO1", ...
        "Ant1_SCS15_F1_NCS15_noCFO1", ...
        "Ant1_SCS15_F1_NCS18_noCFO1", ...
        "Ant1_SCS15_F1_NCS22_noCFO1", ...
        "Ant1_SCS15_F1_NCS26_noCFO1", ...
        "Ant1_SCS15_F1_NCS32_noCFO1", ...
        "Ant1_SCS15_F1_NCS38_noCFO1", ...
        "Ant1_SCS15_F1_NCS46_noCFO1", ...
        "Ant1_SCS15_F1_NCS59_noCFO1", ...
        "Ant1_SCS15_F1_NCS76_noCFO1", ...
        "Ant1_SCS15_F1_NCS93_noCFO1", ...
        "Ant1_SCS15_F1_NCS119_noCFO1", ...
        "Ant1_SCS15_F1_NCS167_noCFO1", ...
        "Ant1_SCS15_F1_NCS279_noCFO1", ...
        "Ant1_SCS15_F1_NCS419_noCFO1", ...
        "Ant2_SCS15_F1_NCS0_noCFO1", ...
        "Ant2_SCS15_F1_NCS13_noCFO1", ...
        "Ant2_SCS15_F1_NCS15_noCFO1", ...
        "Ant2_SCS15_F1_NCS18_noCFO1", ...
        "Ant2_SCS15_F1_NCS22_noCFO1", ...
        "Ant2_SCS15_F1_NCS26_noCFO1", ...
        "Ant2_SCS15_F1_NCS32_noCFO1", ...
        "Ant2_SCS15_F1_NCS38_noCFO1", ...
        "Ant2_SCS15_F1_NCS46_noCFO1", ...
        "Ant2_SCS15_F1_NCS59_noCFO1", ...
        "Ant2_SCS15_F1_NCS76_noCFO1", ...
        "Ant2_SCS15_F1_NCS93_noCFO1", ...
        "Ant2_SCS15_F1_NCS119_noCFO1", ...
        "Ant2_SCS15_F1_NCS167_noCFO1", ...
        "Ant2_SCS15_F1_NCS279_noCFO1", ...
        "Ant2_SCS15_F1_NCS419_noCFO1", ...
        "Ant4_SCS15_F1_NCS0_noCFO1", ...
        "Ant4_SCS15_F1_NCS13_noCFO1", ...
        "Ant4_SCS15_F1_NCS15_noCFO1", ...
        "Ant4_SCS15_F1_NCS18_noCFO1", ...
        "Ant4_SCS15_F1_NCS22_noCFO1", ...
        "Ant4_SCS15_F1_NCS26_noCFO1", ...
        "Ant4_SCS15_F1_NCS32_noCFO1", ...
        "Ant4_SCS15_F1_NCS38_noCFO1", ...
        "Ant4_SCS15_F1_NCS46_noCFO1", ...
        "Ant4_SCS15_F1_NCS59_noCFO1", ...
        "Ant4_SCS15_F1_NCS76_noCFO1", ...
        "Ant4_SCS15_F1_NCS93_noCFO1", ...
        "Ant4_SCS15_F1_NCS119_noCFO1", ...
        "Ant4_SCS15_F1_NCS167_noCFO1", ...
        "Ant4_SCS15_F1_NCS279_noCFO1", ...
        "Ant4_SCS15_F1_NCS419_noCFO1", ...
        "Ant1_SCS15_F2_NCS0_noCFO1", ...
        "Ant1_SCS15_F2_NCS13_noCFO1", ...
        "Ant1_SCS15_F2_NCS15_noCFO1", ...
        "Ant1_SCS15_F2_NCS18_noCFO1", ...
        "Ant1_SCS15_F2_NCS22_noCFO1", ...
        "Ant1_SCS15_F2_NCS26_noCFO1", ...
        "Ant1_SCS15_F2_NCS32_noCFO1", ...
        "Ant1_SCS15_F2_NCS38_noCFO1", ...
        "Ant1_SCS15_F2_NCS46_noCFO1", ...
        "Ant1_SCS15_F2_NCS59_noCFO1", ...
        "Ant1_SCS15_F2_NCS76_noCFO1", ...
        "Ant1_SCS15_F2_NCS93_noCFO1", ...
        "Ant1_SCS15_F2_NCS119_noCFO1", ...
        "Ant1_SCS15_F2_NCS167_noCFO1", ...
        "Ant1_SCS15_F2_NCS279_noCFO1", ...
        "Ant1_SCS15_F2_NCS419_noCFO1", ...
        "Ant2_SCS15_F2_NCS0_noCFO1", ...
        "Ant2_SCS15_F2_NCS13_noCFO1", ...
        "Ant2_SCS15_F2_NCS15_noCFO1", ...
        "Ant2_SCS15_F2_NCS18_noCFO1", ...
        "Ant2_SCS15_F2_NCS22_noCFO1", ...
        "Ant2_SCS15_F2_NCS26_noCFO1", ...
        "Ant2_SCS15_F2_NCS32_noCFO1", ...
        "Ant2_SCS15_F2_NCS38_noCFO1", ...
        "Ant2_SCS15_F2_NCS46_noCFO1", ...
        "Ant2_SCS15_F2_NCS59_noCFO1", ...
        "Ant2_SCS15_F2_NCS76_noCFO1", ...
        "Ant2_SCS15_F2_NCS93_noCFO1", ...
        "Ant2_SCS15_F2_NCS119_noCFO1", ...
        "Ant2_SCS15_F2_NCS167_noCFO1", ...
        "Ant2_SCS15_F2_NCS279_noCFO1", ...
        "Ant2_SCS15_F2_NCS419_noCFO1", ...
        "Ant4_SCS15_F2_NCS0_noCFO1", ...
        "Ant4_SCS15_F2_NCS13_noCFO1", ...
        "Ant4_SCS15_F2_NCS15_noCFO1", ...
        "Ant4_SCS15_F2_NCS18_noCFO1", ...
        "Ant4_SCS15_F2_NCS22_noCFO1", ...
        "Ant4_SCS15_F2_NCS26_noCFO1", ...
        "Ant4_SCS15_F2_NCS32_noCFO1", ...
        "Ant4_SCS15_F2_NCS38_noCFO1", ...
        "Ant4_SCS15_F2_NCS46_noCFO1", ...
        "Ant4_SCS15_F2_NCS59_noCFO1", ...
        "Ant4_SCS15_F2_NCS76_noCFO1", ...
        "Ant4_SCS15_F2_NCS93_noCFO1", ...
        "Ant4_SCS15_F2_NCS119_noCFO1", ...
        "Ant4_SCS15_F2_NCS167_noCFO1", ...
        "Ant4_SCS15_F2_NCS279_noCFO1", ...
        "Ant4_SCS15_F2_NCS419_noCFO1", ...
        "Ant1_SCS15_FA1_NCS0_noCFO1", ...
        "Ant1_SCS15_FA1_NCS2_noCFO1", ...
        "Ant1_SCS15_FA1_NCS4_noCFO1", ...
        "Ant1_SCS15_FA1_NCS6_noCFO1", ...
        "Ant1_SCS15_FA1_NCS8_noCFO1", ...
        "Ant1_SCS15_FA1_NCS10_noCFO1", ...
        "Ant1_SCS15_FA1_NCS12_noCFO1", ...
        "Ant1_SCS15_FA1_NCS13_noCFO1", ...
        "Ant1_SCS15_FA1_NCS15_noCFO1", ...
        "Ant1_SCS15_FA1_NCS17_noCFO1", ...
        "Ant1_SCS15_FA1_NCS19_noCFO1", ...
        "Ant1_SCS15_FA1_NCS23_noCFO1", ...
        "Ant1_SCS15_FA1_NCS27_noCFO1", ...
        "Ant1_SCS15_FA1_NCS34_noCFO1", ...
        "Ant1_SCS15_FA1_NCS46_noCFO1", ...
        "Ant1_SCS15_FA1_NCS69_noCFO1", ...
        "Ant2_SCS15_FA1_NCS0_noCFO1", ...
        "Ant2_SCS15_FA1_NCS2_noCFO1", ...
        "Ant2_SCS15_FA1_NCS4_noCFO1", ...
        "Ant2_SCS15_FA1_NCS6_noCFO1", ...
        "Ant2_SCS15_FA1_NCS8_noCFO1", ...
        "Ant2_SCS15_FA1_NCS10_noCFO1", ...
        "Ant2_SCS15_FA1_NCS12_noCFO1", ...
        "Ant2_SCS15_FA1_NCS13_noCFO1", ...
        "Ant2_SCS15_FA1_NCS15_noCFO1", ...
        "Ant2_SCS15_FA1_NCS17_noCFO1", ...
        "Ant2_SCS15_FA1_NCS19_noCFO1", ...
        "Ant2_SCS15_FA1_NCS23_noCFO1", ...
        "Ant2_SCS15_FA1_NCS27_noCFO1", ...
        "Ant2_SCS15_FA1_NCS34_noCFO1", ...
        "Ant2_SCS15_FA1_NCS46_noCFO1", ...
        "Ant2_SCS15_FA1_NCS69_noCFO1", ...
        "Ant4_SCS15_FA1_NCS0_noCFO1", ...
        "Ant4_SCS15_FA1_NCS2_noCFO1", ...
        "Ant4_SCS15_FA1_NCS4_noCFO1", ...
        "Ant4_SCS15_FA1_NCS6_noCFO1", ...
        "Ant4_SCS15_FA1_NCS8_noCFO1", ...
        "Ant4_SCS15_FA1_NCS10_noCFO1", ...
        "Ant4_SCS15_FA1_NCS12_noCFO1", ...
        "Ant4_SCS15_FA1_NCS13_noCFO1", ...
        "Ant4_SCS15_FA1_NCS15_noCFO1", ...
        "Ant4_SCS15_FA1_NCS17_noCFO1", ...
        "Ant4_SCS15_FA1_NCS19_noCFO1", ...
        "Ant4_SCS15_FA1_NCS23_noCFO1", ...
        "Ant4_SCS15_FA1_NCS27_noCFO1", ...
        "Ant4_SCS15_FA1_NCS34_noCFO1", ...
        "Ant4_SCS15_FA1_NCS46_noCFO1", ...
        "Ant4_SCS15_FA1_NCS69_noCFO1", ...
        "Ant1_SCS30_FA1_NCS0_noCFO1", ...
        "Ant1_SCS30_FA1_NCS2_noCFO1", ...
        "Ant1_SCS30_FA1_NCS4_noCFO1", ...
        "Ant1_SCS30_FA1_NCS6_noCFO1", ...
        "Ant1_SCS30_FA1_NCS8_noCFO1", ...
        "Ant1_SCS30_FA1_NCS10_noCFO1", ...
        "Ant1_SCS30_FA1_NCS12_noCFO1", ...
        "Ant1_SCS30_FA1_NCS13_noCFO1", ...
        "Ant1_SCS30_FA1_NCS15_noCFO1", ...
        "Ant1_SCS30_FA1_NCS17_noCFO1", ...
        "Ant1_SCS30_FA1_NCS19_noCFO1", ...
        "Ant1_SCS30_FA1_NCS23_noCFO1", ...
        "Ant1_SCS30_FA1_NCS27_noCFO1", ...
        "Ant1_SCS30_FA1_NCS34_noCFO1", ...
        "Ant1_SCS30_FA1_NCS46_noCFO1", ...
        "Ant1_SCS30_FA1_NCS69_noCFO1", ...
        "Ant2_SCS30_FA1_NCS0_noCFO1", ...
        "Ant2_SCS30_FA1_NCS2_noCFO1", ...
        "Ant2_SCS30_FA1_NCS4_noCFO1", ...
        "Ant2_SCS30_FA1_NCS6_noCFO1", ...
        "Ant2_SCS30_FA1_NCS8_noCFO1", ...
        "Ant2_SCS30_FA1_NCS10_noCFO1", ...
        "Ant2_SCS30_FA1_NCS12_noCFO1", ...
        "Ant2_SCS30_FA1_NCS13_noCFO1", ...
        "Ant2_SCS30_FA1_NCS15_noCFO1", ...
        "Ant2_SCS30_FA1_NCS17_noCFO1", ...
        "Ant2_SCS30_FA1_NCS19_noCFO1", ...
        "Ant2_SCS30_FA1_NCS23_noCFO1", ...
        "Ant2_SCS30_FA1_NCS27_noCFO1", ...
        "Ant2_SCS30_FA1_NCS34_noCFO1", ...
        "Ant2_SCS30_FA1_NCS46_noCFO1", ...
        "Ant2_SCS30_FA1_NCS69_noCFO1", ...
        "Ant4_SCS30_FA1_NCS0_noCFO1", ...
        "Ant4_SCS30_FA1_NCS2_noCFO1", ...
        "Ant4_SCS30_FA1_NCS4_noCFO1", ...
        "Ant4_SCS30_FA1_NCS6_noCFO1", ...
        "Ant4_SCS30_FA1_NCS8_noCFO1", ...
        "Ant4_SCS30_FA1_NCS10_noCFO1", ...
        "Ant4_SCS30_FA1_NCS12_noCFO1", ...
        "Ant4_SCS30_FA1_NCS13_noCFO1", ...
        "Ant4_SCS30_FA1_NCS15_noCFO1", ...
        "Ant4_SCS30_FA1_NCS17_noCFO1", ...
        "Ant4_SCS30_FA1_NCS19_noCFO1", ...
        "Ant4_SCS30_FA1_NCS23_noCFO1", ...
        "Ant4_SCS30_FA1_NCS27_noCFO1", ...
        "Ant4_SCS30_FA1_NCS34_noCFO1", ...
        "Ant4_SCS30_FA1_NCS46_noCFO1", ...
        "Ant4_SCS30_FA1_NCS69_noCFO1", ...
        "Ant1_SCS15_FA2_NCS0_noCFO1", ...
        "Ant1_SCS15_FA2_NCS2_noCFO1", ...
        "Ant1_SCS15_FA2_NCS4_noCFO1", ...
        "Ant1_SCS15_FA2_NCS6_noCFO1", ...
        "Ant1_SCS15_FA2_NCS8_noCFO1", ...
        "Ant1_SCS15_FA2_NCS10_noCFO1", ...
        "Ant1_SCS15_FA2_NCS12_noCFO1", ...
        "Ant1_SCS15_FA2_NCS13_noCFO1", ...
        "Ant1_SCS15_FA2_NCS15_noCFO1", ...
        "Ant1_SCS15_FA2_NCS17_noCFO1", ...
        "Ant1_SCS15_FA2_NCS19_noCFO1", ...
        "Ant1_SCS15_FA2_NCS23_noCFO1", ...
        "Ant1_SCS15_FA2_NCS27_noCFO1", ...
        "Ant1_SCS15_FA2_NCS34_noCFO1", ...
        "Ant1_SCS15_FA2_NCS46_noCFO1", ...
        "Ant1_SCS15_FA2_NCS69_noCFO1", ...
        "Ant2_SCS15_FA2_NCS0_noCFO1", ...
        "Ant2_SCS15_FA2_NCS2_noCFO1", ...
        "Ant2_SCS15_FA2_NCS4_noCFO1", ...
        "Ant2_SCS15_FA2_NCS6_noCFO1", ...
        "Ant2_SCS15_FA2_NCS8_noCFO1", ...
        "Ant2_SCS15_FA2_NCS10_noCFO1", ...
        "Ant2_SCS15_FA2_NCS12_noCFO1", ...
        "Ant2_SCS15_FA2_NCS13_noCFO1", ...
        "Ant2_SCS15_FA2_NCS15_noCFO1", ...
        "Ant2_SCS15_FA2_NCS17_noCFO1", ...
        "Ant2_SCS15_FA2_NCS19_noCFO1", ...
        "Ant2_SCS15_FA2_NCS23_noCFO1", ...
        "Ant2_SCS15_FA2_NCS27_noCFO1", ...
        "Ant2_SCS15_FA2_NCS34_noCFO1", ...
        "Ant2_SCS15_FA2_NCS46_noCFO1", ...
        "Ant2_SCS15_FA2_NCS69_noCFO1", ...
        "Ant4_SCS15_FA2_NCS0_noCFO1", ...
        "Ant4_SCS15_FA2_NCS2_noCFO1", ...
        "Ant4_SCS15_FA2_NCS4_noCFO1", ...
        "Ant4_SCS15_FA2_NCS6_noCFO1", ...
        "Ant4_SCS15_FA2_NCS8_noCFO1", ...
        "Ant4_SCS15_FA2_NCS10_noCFO1", ...
        "Ant4_SCS15_FA2_NCS12_noCFO1", ...
        "Ant4_SCS15_FA2_NCS13_noCFO1", ...
        "Ant4_SCS15_FA2_NCS15_noCFO1", ...
        "Ant4_SCS15_FA2_NCS17_noCFO1", ...
        "Ant4_SCS15_FA2_NCS19_noCFO1", ...
        "Ant4_SCS15_FA2_NCS23_noCFO1", ...
        "Ant4_SCS15_FA2_NCS27_noCFO1", ...
        "Ant4_SCS15_FA2_NCS34_noCFO1", ...
        "Ant4_SCS15_FA2_NCS46_noCFO1", ...
        "Ant4_SCS15_FA2_NCS69_noCFO1", ...
        "Ant1_SCS30_FA2_NCS0_noCFO1", ...
        "Ant1_SCS30_FA2_NCS2_noCFO1", ...
        "Ant1_SCS30_FA2_NCS4_noCFO1", ...
        "Ant1_SCS30_FA2_NCS6_noCFO1", ...
        "Ant1_SCS30_FA2_NCS8_noCFO1", ...
        "Ant1_SCS30_FA2_NCS10_noCFO1", ...
        "Ant1_SCS30_FA2_NCS12_noCFO1", ...
        "Ant1_SCS30_FA2_NCS13_noCFO1", ...
        "Ant1_SCS30_FA2_NCS15_noCFO1", ...
        "Ant1_SCS30_FA2_NCS17_noCFO1", ...
        "Ant1_SCS30_FA2_NCS19_noCFO1", ...
        "Ant1_SCS30_FA2_NCS23_noCFO1", ...
        "Ant1_SCS30_FA2_NCS27_noCFO1", ...
        "Ant1_SCS30_FA2_NCS34_noCFO1", ...
        "Ant1_SCS30_FA2_NCS46_noCFO1", ...
        "Ant1_SCS30_FA2_NCS69_noCFO1", ...
        "Ant2_SCS30_FA2_NCS0_noCFO1", ...
        "Ant2_SCS30_FA2_NCS2_noCFO1", ...
        "Ant2_SCS30_FA2_NCS4_noCFO1", ...
        "Ant2_SCS30_FA2_NCS6_noCFO1", ...
        "Ant2_SCS30_FA2_NCS8_noCFO1", ...
        "Ant2_SCS30_FA2_NCS10_noCFO1", ...
        "Ant2_SCS30_FA2_NCS12_noCFO1", ...
        "Ant2_SCS30_FA2_NCS13_noCFO1", ...
        "Ant2_SCS30_FA2_NCS15_noCFO1", ...
        "Ant2_SCS30_FA2_NCS17_noCFO1", ...
        "Ant2_SCS30_FA2_NCS19_noCFO1", ...
        "Ant2_SCS30_FA2_NCS23_noCFO1", ...
        "Ant2_SCS30_FA2_NCS27_noCFO1", ...
        "Ant2_SCS30_FA2_NCS34_noCFO1", ...
        "Ant2_SCS30_FA2_NCS46_noCFO1", ...
        "Ant2_SCS30_FA2_NCS69_noCFO1", ...
        "Ant4_SCS30_FA2_NCS0_noCFO1", ...
        "Ant4_SCS30_FA2_NCS2_noCFO1", ...
        "Ant4_SCS30_FA2_NCS4_noCFO1", ...
        "Ant4_SCS30_FA2_NCS6_noCFO1", ...
        "Ant4_SCS30_FA2_NCS8_noCFO1", ...
        "Ant4_SCS30_FA2_NCS10_noCFO1", ...
        "Ant4_SCS30_FA2_NCS12_noCFO1", ...
        "Ant4_SCS30_FA2_NCS13_noCFO1", ...
        "Ant4_SCS30_FA2_NCS15_noCFO1", ...
        "Ant4_SCS30_FA2_NCS17_noCFO1", ...
        "Ant4_SCS30_FA2_NCS19_noCFO1", ...
        "Ant4_SCS30_FA2_NCS23_noCFO1", ...
        "Ant4_SCS30_FA2_NCS27_noCFO1", ...
        "Ant4_SCS30_FA2_NCS34_noCFO1", ...
        "Ant4_SCS30_FA2_NCS46_noCFO1", ...
        "Ant4_SCS30_FA2_NCS69_noCFO1", ...
        "Ant1_SCS15_FB4_NCS0_noCFO1", ...
        "Ant1_SCS15_FB4_NCS2_noCFO1", ...
        "Ant1_SCS15_FB4_NCS4_noCFO1", ...
        "Ant1_SCS15_FB4_NCS6_noCFO1", ...
        "Ant1_SCS15_FB4_NCS8_noCFO1", ...
        "Ant1_SCS15_FB4_NCS10_noCFO1", ...
        "Ant1_SCS15_FB4_NCS12_noCFO1", ...
        "Ant1_SCS15_FB4_NCS13_noCFO1", ...
        "Ant1_SCS15_FB4_NCS15_noCFO1", ...
        "Ant1_SCS15_FB4_NCS17_noCFO1", ...
        "Ant1_SCS15_FB4_NCS19_noCFO1", ...
        "Ant1_SCS15_FB4_NCS23_noCFO1", ...
        "Ant1_SCS15_FB4_NCS27_noCFO1", ...
        "Ant1_SCS15_FB4_NCS34_noCFO1", ...
        "Ant1_SCS15_FB4_NCS46_noCFO1", ...
        "Ant1_SCS15_FB4_NCS69_noCFO1", ...
        "Ant2_SCS15_FB4_NCS0_noCFO1", ...
        "Ant2_SCS15_FB4_NCS2_noCFO1", ...
        "Ant2_SCS15_FB4_NCS4_noCFO1", ...
        "Ant2_SCS15_FB4_NCS6_noCFO1", ...
        "Ant2_SCS15_FB4_NCS8_noCFO1", ...
        "Ant2_SCS15_FB4_NCS10_noCFO1", ...
        "Ant2_SCS15_FB4_NCS12_noCFO1", ...
        "Ant2_SCS15_FB4_NCS13_noCFO1", ...
        "Ant2_SCS15_FB4_NCS15_noCFO1", ...
        "Ant2_SCS15_FB4_NCS17_noCFO1", ...
        "Ant2_SCS15_FB4_NCS19_noCFO1", ...
        "Ant2_SCS15_FB4_NCS23_noCFO1", ...
        "Ant2_SCS15_FB4_NCS27_noCFO1", ...
        "Ant2_SCS15_FB4_NCS34_noCFO1", ...
        "Ant2_SCS15_FB4_NCS46_noCFO1", ...
        "Ant2_SCS15_FB4_NCS69_noCFO1", ...
        "Ant4_SCS15_FB4_NCS0_noCFO1", ...
        "Ant4_SCS15_FB4_NCS2_noCFO1", ...
        "Ant4_SCS15_FB4_NCS4_noCFO1", ...
        "Ant4_SCS15_FB4_NCS6_noCFO1", ...
        "Ant4_SCS15_FB4_NCS8_noCFO1", ...
        "Ant4_SCS15_FB4_NCS10_noCFO1", ...
        "Ant4_SCS15_FB4_NCS12_noCFO1", ...
        "Ant4_SCS15_FB4_NCS13_noCFO1", ...
        "Ant4_SCS15_FB4_NCS15_noCFO1", ...
        "Ant4_SCS15_FB4_NCS17_noCFO1", ...
        "Ant4_SCS15_FB4_NCS19_noCFO1", ...
        "Ant4_SCS15_FB4_NCS23_noCFO1", ...
        "Ant4_SCS15_FB4_NCS27_noCFO1", ...
        "Ant4_SCS15_FB4_NCS34_noCFO1", ...
        "Ant4_SCS15_FB4_NCS46_noCFO1", ...
        "Ant4_SCS15_FB4_NCS69_noCFO1", ...
        "Ant1_SCS30_FB4_NCS0_noCFO1", ...
        "Ant1_SCS30_FB4_NCS2_noCFO1", ...
        "Ant1_SCS30_FB4_NCS4_noCFO1", ...
        "Ant1_SCS30_FB4_NCS6_noCFO1", ...
        "Ant1_SCS30_FB4_NCS8_noCFO1", ...
        "Ant1_SCS30_FB4_NCS10_noCFO1", ...
        "Ant1_SCS30_FB4_NCS12_noCFO1", ...
        "Ant1_SCS30_FB4_NCS13_noCFO1", ...
        "Ant1_SCS30_FB4_NCS15_noCFO1", ...
        "Ant1_SCS30_FB4_NCS17_noCFO1", ...
        "Ant1_SCS30_FB4_NCS19_noCFO1", ...
        "Ant1_SCS30_FB4_NCS23_noCFO1", ...
        "Ant1_SCS30_FB4_NCS27_noCFO1", ...
        "Ant1_SCS30_FB4_NCS34_noCFO1", ...
        "Ant1_SCS30_FB4_NCS46_noCFO1", ...
        "Ant1_SCS30_FB4_NCS69_noCFO1", ...
        "Ant2_SCS30_FB4_NCS0_noCFO1", ...
        "Ant2_SCS30_FB4_NCS2_noCFO1", ...
        "Ant2_SCS30_FB4_NCS4_noCFO1", ...
        "Ant2_SCS30_FB4_NCS6_noCFO1", ...
        "Ant2_SCS30_FB4_NCS8_noCFO1", ...
        "Ant2_SCS30_FB4_NCS10_noCFO1", ...
        "Ant2_SCS30_FB4_NCS12_noCFO1", ...
        "Ant2_SCS30_FB4_NCS13_noCFO1", ...
        "Ant2_SCS30_FB4_NCS15_noCFO1", ...
        "Ant2_SCS30_FB4_NCS17_noCFO1", ...
        "Ant2_SCS30_FB4_NCS19_noCFO1", ...
        "Ant2_SCS30_FB4_NCS23_noCFO1", ...
        "Ant2_SCS30_FB4_NCS27_noCFO1", ...
        "Ant2_SCS30_FB4_NCS34_noCFO1", ...
        "Ant2_SCS30_FB4_NCS46_noCFO1", ...
        "Ant2_SCS30_FB4_NCS69_noCFO1", ...
        "Ant4_SCS30_FB4_NCS0_noCFO1", ...
        "Ant4_SCS30_FB4_NCS2_noCFO1", ...
        "Ant4_SCS30_FB4_NCS4_noCFO1", ...
        "Ant4_SCS30_FB4_NCS6_noCFO1", ...
        "Ant4_SCS30_FB4_NCS8_noCFO1", ...
        "Ant4_SCS30_FB4_NCS10_noCFO1", ...
        "Ant4_SCS30_FB4_NCS12_noCFO1", ...
        "Ant4_SCS30_FB4_NCS13_noCFO1", ...
        "Ant4_SCS30_FB4_NCS15_noCFO1", ...
        "Ant4_SCS30_FB4_NCS17_noCFO1", ...
        "Ant4_SCS30_FB4_NCS19_noCFO1", ...
        "Ant4_SCS30_FB4_NCS23_noCFO1", ...
        "Ant4_SCS30_FB4_NCS27_noCFO1", ...
        "Ant4_SCS30_FB4_NCS34_noCFO1", ...
        "Ant4_SCS30_FB4_NCS46_noCFO1", ...
        "Ant4_SCS30_FB4_NCS69_noCFO1", ...
        ];
    ThresholdsMargins = { ...
        [0.147,  5, 1], ... % Ant1_SCS15_F0_NCS0_noCFO1
        [1.000,  5, 1], ... % Ant1_SCS15_F0_NCS13_noCFO1
        [0.874,  5, 1], ... % Ant1_SCS15_F0_NCS15_noCFO1
        [0.774,  5, 1], ... % Ant1_SCS15_F0_NCS18_noCFO1
        [0.640,  5, 1], ... % Ant1_SCS15_F0_NCS22_noCFO1
        [0.551,  5, 1], ... % Ant1_SCS15_F0_NCS26_noCFO1
        [0.449,  5, 1], ... % Ant1_SCS15_F0_NCS32_noCFO1
        [0.388,  5, 1], ... % Ant1_SCS15_F0_NCS38_noCFO1
        [0.321,  5, 1], ... % Ant1_SCS15_F0_NCS46_noCFO1
        [0.255,  5, 1], ... % Ant1_SCS15_F0_NCS59_noCFO1
        [0.205,  5, 1], ... % Ant1_SCS15_F0_NCS76_noCFO1
        [0.167,  5, 1], ... % Ant1_SCS15_F0_NCS93_noCFO1
        [0.147,  5, 1], ... % Ant1_SCS15_F0_NCS119_noCFO1
        [0.148,  5, 1], ... % Ant1_SCS15_F0_NCS167_noCFO1
        [0.148,  5, 0], ... % Ant1_SCS15_F0_NCS279_noCFO1
        [0.148,  5, 0], ... % Ant1_SCS15_F0_NCS419_noCFO1
        [0.085,  5, 2], ... % Ant2_SCS15_F0_NCS0_noCFO1
        [0.517,  5, 1], ... % Ant2_SCS15_F0_NCS13_noCFO1
        [0.451,  5, 1], ... % Ant2_SCS15_F0_NCS15_noCFO1
        [0.404,  5, 1], ... % Ant2_SCS15_F0_NCS18_noCFO1
        [0.344,  5, 1], ... % Ant2_SCS15_F0_NCS22_noCFO1
        [0.301,  5, 2], ... % Ant2_SCS15_F0_NCS26_noCFO1
        [0.249,  5, 1], ... % Ant2_SCS15_F0_NCS32_noCFO1
        [0.219,  5, 1], ... % Ant2_SCS15_F0_NCS38_noCFO1
        [0.180,  5, 1], ... % Ant2_SCS15_F0_NCS46_noCFO1
        [0.146,  5, 1], ... % Ant2_SCS15_F0_NCS59_noCFO1
        [0.118,  5, 1], ... % Ant2_SCS15_F0_NCS76_noCFO1
        [0.098,  5, 1], ... % Ant2_SCS15_F0_NCS93_noCFO1
        [0.085,  5, 2], ... % Ant2_SCS15_F0_NCS119_noCFO1
        [0.086,  5, 1], ... % Ant2_SCS15_F0_NCS167_noCFO1
        [0.085,  5, 0], ... % Ant2_SCS15_F0_NCS279_noCFO1
        [0.085,  5, 0], ... % Ant2_SCS15_F0_NCS419_noCFO1
        [0.053,  5, 2], ... % Ant4_SCS15_F0_NCS0_noCFO1
        [0.303,  5, 1], ... % Ant4_SCS15_F0_NCS13_noCFO1
        [0.269,  5, 1], ... % Ant4_SCS15_F0_NCS15_noCFO1
        [0.240,  5, 1], ... % Ant4_SCS15_F0_NCS18_noCFO1
        [0.207,  5, 1], ... % Ant4_SCS15_F0_NCS22_noCFO1
        [0.180,  5, 1], ... % Ant4_SCS15_F0_NCS26_noCFO1
        [0.149,  5, 1], ... % Ant4_SCS15_F0_NCS32_noCFO1
        [0.131,  5, 2], ... % Ant4_SCS15_F0_NCS38_noCFO1
        [0.112,  5, 1], ... % Ant4_SCS15_F0_NCS46_noCFO1
        [0.090,  5, 2], ... % Ant4_SCS15_F0_NCS59_noCFO1
        [0.072,  5, 1], ... % Ant4_SCS15_F0_NCS76_noCFO1
        [0.060,  5, 1], ... % Ant4_SCS15_F0_NCS93_noCFO1
        [0.052,  5, 1], ... % Ant4_SCS15_F0_NCS119_noCFO1
        [0.052,  5, 1], ... % Ant4_SCS15_F0_NCS167_noCFO1
        [0.052,  5, 0], ... % Ant4_SCS15_F0_NCS279_noCFO1
        [0.053,  5, 0], ... % Ant4_SCS15_F0_NCS419_noCFO1
        [0.025,  5, 1], ... % Ant1_SCS15_F1_NCS0_noCFO1
        [1.000,  5, 1], ... % Ant1_SCS15_F1_NCS13_noCFO1
        [0.869,  5, 1], ... % Ant1_SCS15_F1_NCS15_noCFO1
        [0.781,  5, 1], ... % Ant1_SCS15_F1_NCS18_noCFO1
        [0.636,  5, 1], ... % Ant1_SCS15_F1_NCS22_noCFO1
        [0.548,  5, 1], ... % Ant1_SCS15_F1_NCS26_noCFO1
        [0.455,  5, 1], ... % Ant1_SCS15_F1_NCS32_noCFO1
        [0.387,  5, 1], ... % Ant1_SCS15_F1_NCS38_noCFO1
        [0.328,  5, 1], ... % Ant1_SCS15_F1_NCS46_noCFO1
        [0.256,  5, 1], ... % Ant1_SCS15_F1_NCS59_noCFO1
        [0.205,  5, 1], ... % Ant1_SCS15_F1_NCS76_noCFO1
        [0.169,  5, 1], ... % Ant1_SCS15_F1_NCS93_noCFO1
        [0.134,  5, 1], ... % Ant1_SCS15_F1_NCS119_noCFO1
        [0.097,  5, 1], ... % Ant1_SCS15_F1_NCS167_noCFO1
        [0.060,  5, 1], ... % Ant1_SCS15_F1_NCS279_noCFO1
        [0.041,  5, 1], ... % Ant1_SCS15_F1_NCS419_noCFO1
        [0.014,  5, 1], ... % Ant2_SCS15_F1_NCS0_noCFO1
        [0.510,  5, 1], ... % Ant2_SCS15_F1_NCS13_noCFO1
        [0.459,  5, 1], ... % Ant2_SCS15_F1_NCS15_noCFO1
        [0.409,  5, 1], ... % Ant2_SCS15_F1_NCS18_noCFO1
        [0.341,  5, 1], ... % Ant2_SCS15_F1_NCS22_noCFO1
        [0.299,  5, 1], ... % Ant2_SCS15_F1_NCS26_noCFO1
        [0.250,  5, 1], ... % Ant2_SCS15_F1_NCS32_noCFO1
        [0.213,  5, 1], ... % Ant2_SCS15_F1_NCS38_noCFO1
        [0.183,  5, 1], ... % Ant2_SCS15_F1_NCS46_noCFO1
        [0.145,  5, 1], ... % Ant2_SCS15_F1_NCS59_noCFO1
        [0.118,  5, 1], ... % Ant2_SCS15_F1_NCS76_noCFO1
        [0.097,  5, 1], ... % Ant2_SCS15_F1_NCS93_noCFO1
        [0.078,  5, 1], ... % Ant2_SCS15_F1_NCS119_noCFO1
        [0.057,  5, 1], ... % Ant2_SCS15_F1_NCS167_noCFO1
        [0.035,  5, 1], ... % Ant2_SCS15_F1_NCS279_noCFO1
        [0.024,  5, 1], ... % Ant2_SCS15_F1_NCS419_noCFO1
        [0.009,  5, 1], ... % Ant4_SCS15_F1_NCS0_noCFO1
        [0.304,  5, 1], ... % Ant4_SCS15_F1_NCS13_noCFO1
        [0.269,  5, 1], ... % Ant4_SCS15_F1_NCS15_noCFO1
        [0.242,  5, 1], ... % Ant4_SCS15_F1_NCS18_noCFO1
        [0.206,  5, 1], ... % Ant4_SCS15_F1_NCS22_noCFO1
        [0.180,  5, 1], ... % Ant4_SCS15_F1_NCS26_noCFO1
        [0.150,  5, 1], ... % Ant4_SCS15_F1_NCS32_noCFO1
        [0.132,  5, 1], ... % Ant4_SCS15_F1_NCS38_noCFO1
        [0.112,  5, 1], ... % Ant4_SCS15_F1_NCS46_noCFO1
        [0.090,  5, 1], ... % Ant4_SCS15_F1_NCS59_noCFO1
        [0.072,  5, 1], ... % Ant4_SCS15_F1_NCS76_noCFO1
        [0.060,  5, 1], ... % Ant4_SCS15_F1_NCS93_noCFO1
        [0.048,  5, 1], ... % Ant4_SCS15_F1_NCS119_noCFO1
        [0.035,  5, 1], ... % Ant4_SCS15_F1_NCS167_noCFO1
        [0.022,  5, 1], ... % Ant4_SCS15_F1_NCS279_noCFO1
        [0.015,  5, 1], ... % Ant4_SCS15_F1_NCS419_noCFO1
        [0.100,  5, 0], ... % Ant1_SCS15_F2_NCS0_noCFO1
        [0.996,  5, 0], ... % Ant1_SCS15_F2_NCS13_noCFO1
        [0.882,  5, 0], ... % Ant1_SCS15_F2_NCS15_noCFO1
        [0.772,  5, 0], ... % Ant1_SCS15_F2_NCS18_noCFO1
        [0.658,  5, 0], ... % Ant1_SCS15_F2_NCS22_noCFO1
        [0.551,  5, 0], ... % Ant1_SCS15_F2_NCS26_noCFO1
        [0.450,  5, 0], ... % Ant1_SCS15_F2_NCS32_noCFO1
        [0.387,  5, 0], ... % Ant1_SCS15_F2_NCS38_noCFO1
        [0.329,  5, 0], ... % Ant1_SCS15_F2_NCS46_noCFO1
        [0.258,  5, 0], ... % Ant1_SCS15_F2_NCS59_noCFO1
        [0.207,  5, 0], ... % Ant1_SCS15_F2_NCS76_noCFO1
        [0.169,  5, 0], ... % Ant1_SCS15_F2_NCS93_noCFO1
        [0.134,  5, 0], ... % Ant1_SCS15_F2_NCS119_noCFO1
        [0.101,  5, 0], ... % Ant1_SCS15_F2_NCS167_noCFO1
        [0.101,  5, 0], ... % Ant1_SCS15_F2_NCS279_noCFO1
        [0.101,  5, 0], ... % Ant1_SCS15_F2_NCS419_noCFO1
        [0.059,  5, 0], ... % Ant2_SCS15_F2_NCS0_noCFO1
        [0.511,  5, 0], ... % Ant2_SCS15_F2_NCS13_noCFO1
        [0.452,  5, 0], ... % Ant2_SCS15_F2_NCS15_noCFO1
        [0.407,  5, 0], ... % Ant2_SCS15_F2_NCS18_noCFO1
        [0.345,  5, 0], ... % Ant2_SCS15_F2_NCS22_noCFO1
        [0.302,  5, 0], ... % Ant2_SCS15_F2_NCS26_noCFO1
        [0.246,  5, 0], ... % Ant2_SCS15_F2_NCS32_noCFO1
        [0.216,  5, 0], ... % Ant2_SCS15_F2_NCS38_noCFO1
        [0.180,  5, 0], ... % Ant2_SCS15_F2_NCS46_noCFO1
        [0.145,  5, 0], ... % Ant2_SCS15_F2_NCS59_noCFO1
        [0.116,  5, 0], ... % Ant2_SCS15_F2_NCS76_noCFO1
        [0.097,  5, 0], ... % Ant2_SCS15_F2_NCS93_noCFO1
        [0.077,  5, 0], ... % Ant2_SCS15_F2_NCS119_noCFO1
        [0.059,  5, 0], ... % Ant2_SCS15_F2_NCS167_noCFO1
        [0.058,  5, 0], ... % Ant2_SCS15_F2_NCS279_noCFO1
        [0.059,  5, 0], ... % Ant2_SCS15_F2_NCS419_noCFO1
        [0.036,  5, 0], ... % Ant4_SCS15_F2_NCS0_noCFO1
        [0.301,  5, 0], ... % Ant4_SCS15_F2_NCS13_noCFO1
        [0.270,  5, 0], ... % Ant4_SCS15_F2_NCS15_noCFO1
        [0.243,  5, 0], ... % Ant4_SCS15_F2_NCS18_noCFO1
        [0.208,  5, 0], ... % Ant4_SCS15_F2_NCS22_noCFO1
        [0.181,  5, 0], ... % Ant4_SCS15_F2_NCS26_noCFO1
        [0.150,  5, 0], ... % Ant4_SCS15_F2_NCS32_noCFO1
        [0.132,  5, 0], ... % Ant4_SCS15_F2_NCS38_noCFO1
        [0.111,  5, 0], ... % Ant4_SCS15_F2_NCS46_noCFO1
        [0.090,  5, 0], ... % Ant4_SCS15_F2_NCS59_noCFO1
        [0.072,  5, 0], ... % Ant4_SCS15_F2_NCS76_noCFO1
        [0.060,  5, 0], ... % Ant4_SCS15_F2_NCS93_noCFO1
        [0.048,  5, 0], ... % Ant4_SCS15_F2_NCS119_noCFO1
        [0.037,  5, 0], ... % Ant4_SCS15_F2_NCS167_noCFO1
        [0.036,  5, 0], ... % Ant4_SCS15_F2_NCS279_noCFO1
        [0.036,  5, 0], ... % Ant4_SCS15_F2_NCS419_noCFO1
        [0.610, 12, 1], ... % Ant1_SCS15_FA1_NCS0_noCFO1
        [1.000, 12, 0], ... % Ant1_SCS15_FA1_NCS2_noCFO1
        [1.000, 12, 0], ... % Ant1_SCS15_FA1_NCS4_noCFO1
        [1.000, 12, 0], ... % Ant1_SCS15_FA1_NCS6_noCFO1
        [0.995, 12, 1], ... % Ant1_SCS15_FA1_NCS8_noCFO1
        [0.876, 12, 1], ... % Ant1_SCS15_FA1_NCS10_noCFO1
        [0.787, 12, 1], ... % Ant1_SCS15_FA1_NCS12_noCFO1
        [0.769, 12, 1], ... % Ant1_SCS15_FA1_NCS13_noCFO1
        [0.690, 12, 1], ... % Ant1_SCS15_FA1_NCS15_noCFO1
        [0.637, 12, 1], ... % Ant1_SCS15_FA1_NCS17_noCFO1
        [0.600, 12, 1], ... % Ant1_SCS15_FA1_NCS19_noCFO1
        [0.607, 12, 1], ... % Ant1_SCS15_FA1_NCS23_noCFO1
        [0.604, 12, 1], ... % Ant1_SCS15_FA1_NCS27_noCFO1
        [0.597, 12, 1], ... % Ant1_SCS15_FA1_NCS34_noCFO1
        [0.603, 12, 1], ... % Ant1_SCS15_FA1_NCS46_noCFO1
        [0.598, 12, 1], ... % Ant1_SCS15_FA1_NCS69_noCFO1
        [0.328, 12, 2], ... % Ant2_SCS15_FA1_NCS0_noCFO1
        [0.692, 12, 0], ... % Ant2_SCS15_FA1_NCS2_noCFO1
        [0.625, 12, 1], ... % Ant2_SCS15_FA1_NCS4_noCFO1
        [0.555, 12, 1], ... % Ant2_SCS15_FA1_NCS6_noCFO1
        [0.507, 12, 1], ... % Ant2_SCS15_FA1_NCS8_noCFO1
        [0.461, 12, 1], ... % Ant2_SCS15_FA1_NCS10_noCFO1
        [0.423, 12, 2], ... % Ant2_SCS15_FA1_NCS12_noCFO1
        [0.409, 12, 2], ... % Ant2_SCS15_FA1_NCS13_noCFO1
        [0.371, 12, 1], ... % Ant2_SCS15_FA1_NCS15_noCFO1
        [0.344, 12, 1], ... % Ant2_SCS15_FA1_NCS17_noCFO1
        [0.323, 12, 2], ... % Ant2_SCS15_FA1_NCS19_noCFO1
        [0.326, 12, 2], ... % Ant2_SCS15_FA1_NCS23_noCFO1
        [0.323, 12, 1], ... % Ant2_SCS15_FA1_NCS27_noCFO1
        [0.324, 12, 2], ... % Ant2_SCS15_FA1_NCS34_noCFO1
        [0.326, 12, 2], ... % Ant2_SCS15_FA1_NCS46_noCFO1
        [0.326, 12, 2], ... % Ant2_SCS15_FA1_NCS69_noCFO1
        [0.195, 12, 2], ... % Ant4_SCS15_FA1_NCS0_noCFO1
        [0.406, 12, 0], ... % Ant4_SCS15_FA1_NCS2_noCFO1
        [0.367, 12, 2], ... % Ant4_SCS15_FA1_NCS4_noCFO1
        [0.328, 12, 2], ... % Ant4_SCS15_FA1_NCS6_noCFO1
        [0.303, 12, 2], ... % Ant4_SCS15_FA1_NCS8_noCFO1
        [0.271, 12, 2], ... % Ant4_SCS15_FA1_NCS10_noCFO1
        [0.246, 12, 1], ... % Ant4_SCS15_FA1_NCS12_noCFO1
        [0.243, 12, 2], ... % Ant4_SCS15_FA1_NCS13_noCFO1
        [0.224, 12, 2], ... % Ant4_SCS15_FA1_NCS15_noCFO1
        [0.206, 12, 1], ... % Ant4_SCS15_FA1_NCS17_noCFO1
        [0.196, 12, 2], ... % Ant4_SCS15_FA1_NCS19_noCFO1
        [0.197, 12, 2], ... % Ant4_SCS15_FA1_NCS23_noCFO1
        [0.196, 12, 1], ... % Ant4_SCS15_FA1_NCS27_noCFO1
        [0.196, 12, 2], ... % Ant4_SCS15_FA1_NCS34_noCFO1
        [0.198, 12, 2], ... % Ant4_SCS15_FA1_NCS46_noCFO1
        [0.196, 12, 2], ... % Ant4_SCS15_FA1_NCS69_noCFO1
        [0.605, 12, 1], ... % Ant1_SCS30_FA1_NCS0_noCFO1
        [1.000, 12, 0], ... % Ant1_SCS30_FA1_NCS2_noCFO1
        [1.000, 12, 0], ... % Ant1_SCS30_FA1_NCS4_noCFO1
        [1.000, 12, 0], ... % Ant1_SCS30_FA1_NCS6_noCFO1
        [0.980, 12, 1], ... % Ant1_SCS30_FA1_NCS8_noCFO1
        [0.879, 12, 1], ... % Ant1_SCS30_FA1_NCS10_noCFO1
        [0.785, 12, 1], ... % Ant1_SCS30_FA1_NCS12_noCFO1
        [0.760, 12, 1], ... % Ant1_SCS30_FA1_NCS13_noCFO1
        [0.692, 12, 1], ... % Ant1_SCS30_FA1_NCS15_noCFO1
        [0.631, 12, 1], ... % Ant1_SCS30_FA1_NCS17_noCFO1
        [0.598, 12, 1], ... % Ant1_SCS30_FA1_NCS19_noCFO1
        [0.602, 12, 1], ... % Ant1_SCS30_FA1_NCS23_noCFO1
        [0.611, 12, 1], ... % Ant1_SCS30_FA1_NCS27_noCFO1
        [0.607, 12, 1], ... % Ant1_SCS30_FA1_NCS34_noCFO1
        [0.605, 12, 1], ... % Ant1_SCS30_FA1_NCS46_noCFO1
        [0.607, 12, 1], ... % Ant1_SCS30_FA1_NCS69_noCFO1
        [0.322, 12, 1], ... % Ant2_SCS30_FA1_NCS0_noCFO1
        [0.686, 12, 0], ... % Ant2_SCS30_FA1_NCS2_noCFO1
        [0.617, 12, 1], ... % Ant2_SCS30_FA1_NCS4_noCFO1
        [0.554, 12, 1], ... % Ant2_SCS30_FA1_NCS6_noCFO1
        [0.516, 12, 1], ... % Ant2_SCS30_FA1_NCS8_noCFO1
        [0.460, 12, 1], ... % Ant2_SCS30_FA1_NCS10_noCFO1
        [0.416, 12, 1], ... % Ant2_SCS30_FA1_NCS12_noCFO1
        [0.406, 12, 1], ... % Ant2_SCS30_FA1_NCS13_noCFO1
        [0.374, 12, 1], ... % Ant2_SCS30_FA1_NCS15_noCFO1
        [0.342, 12, 1], ... % Ant2_SCS30_FA1_NCS17_noCFO1
        [0.323, 12, 1], ... % Ant2_SCS30_FA1_NCS19_noCFO1
        [0.325, 12, 2], ... % Ant2_SCS30_FA1_NCS23_noCFO1
        [0.326, 12, 2], ... % Ant2_SCS30_FA1_NCS27_noCFO1
        [0.326, 12, 2], ... % Ant2_SCS30_FA1_NCS34_noCFO1
        [0.324, 12, 1], ... % Ant2_SCS30_FA1_NCS46_noCFO1
        [0.321, 12, 1], ... % Ant2_SCS30_FA1_NCS69_noCFO1
        [0.195, 12, 2], ... % Ant4_SCS30_FA1_NCS0_noCFO1
        [0.401, 12, 0], ... % Ant4_SCS30_FA1_NCS2_noCFO1
        [0.358, 12, 1], ... % Ant4_SCS30_FA1_NCS4_noCFO1
        [0.325, 12, 1], ... % Ant4_SCS30_FA1_NCS6_noCFO1
        [0.302, 12, 2], ... % Ant4_SCS30_FA1_NCS8_noCFO1
        [0.271, 12, 1], ... % Ant4_SCS30_FA1_NCS10_noCFO1
        [0.244, 12, 1], ... % Ant4_SCS30_FA1_NCS12_noCFO1
        [0.241, 12, 1], ... % Ant4_SCS30_FA1_NCS13_noCFO1
        [0.222, 12, 1], ... % Ant4_SCS30_FA1_NCS15_noCFO1
        [0.204, 12, 1], ... % Ant4_SCS30_FA1_NCS17_noCFO1
        [0.194, 12, 1], ... % Ant4_SCS30_FA1_NCS19_noCFO1
        [0.195, 12, 1], ... % Ant4_SCS30_FA1_NCS23_noCFO1
        [0.195, 12, 1], ... % Ant4_SCS30_FA1_NCS27_noCFO1
        [0.195, 12, 2], ... % Ant4_SCS30_FA1_NCS34_noCFO1
        [0.195, 12, 1], ... % Ant4_SCS30_FA1_NCS46_noCFO1
        [0.195, 12, 1], ... % Ant4_SCS30_FA1_NCS69_noCFO1
        [0.352, 12, 1], ... % Ant1_SCS15_FA2_NCS0_noCFO1
        [1.000, 12, 0], ... % Ant1_SCS15_FA2_NCS2_noCFO1
        [1.000, 12, 0], ... % Ant1_SCS15_FA2_NCS4_noCFO1
        [1.000, 12, 0], ... % Ant1_SCS15_FA2_NCS6_noCFO1
        [0.987, 12, 1], ... % Ant1_SCS15_FA2_NCS8_noCFO1
        [0.868, 12, 1], ... % Ant1_SCS15_FA2_NCS10_noCFO1
        [0.789, 12, 1], ... % Ant1_SCS15_FA2_NCS12_noCFO1
        [0.762, 12, 1], ... % Ant1_SCS15_FA2_NCS13_noCFO1
        [0.696, 12, 1], ... % Ant1_SCS15_FA2_NCS15_noCFO1
        [0.633, 12, 1], ... % Ant1_SCS15_FA2_NCS17_noCFO1
        [0.602, 12, 1], ... % Ant1_SCS15_FA2_NCS19_noCFO1
        [0.516, 12, 1], ... % Ant1_SCS15_FA2_NCS23_noCFO1
        [0.461, 12, 1], ... % Ant1_SCS15_FA2_NCS27_noCFO1
        [0.388, 12, 1], ... % Ant1_SCS15_FA2_NCS34_noCFO1
        [0.350, 12, 1], ... % Ant1_SCS15_FA2_NCS46_noCFO1
        [0.353, 12, 1], ... % Ant1_SCS15_FA2_NCS69_noCFO1
        [0.192, 12, 1], ... % Ant2_SCS15_FA2_NCS0_noCFO1
        [0.688, 12, 0], ... % Ant2_SCS15_FA2_NCS2_noCFO1
        [0.625, 12, 1], ... % Ant2_SCS15_FA2_NCS4_noCFO1
        [0.568, 12, 1], ... % Ant2_SCS15_FA2_NCS6_noCFO1
        [0.516, 12, 1], ... % Ant2_SCS15_FA2_NCS8_noCFO1
        [0.460, 12, 1], ... % Ant2_SCS15_FA2_NCS10_noCFO1
        [0.416, 12, 2], ... % Ant2_SCS15_FA2_NCS12_noCFO1
        [0.407, 12, 2], ... % Ant2_SCS15_FA2_NCS13_noCFO1
        [0.372, 12, 2], ... % Ant2_SCS15_FA2_NCS15_noCFO1
        [0.342, 12, 1], ... % Ant2_SCS15_FA2_NCS17_noCFO1
        [0.324, 12, 2], ... % Ant2_SCS15_FA2_NCS19_noCFO1
        [0.281, 12, 2], ... % Ant2_SCS15_FA2_NCS23_noCFO1
        [0.255, 12, 2], ... % Ant2_SCS15_FA2_NCS27_noCFO1
        [0.218, 12, 2], ... % Ant2_SCS15_FA2_NCS34_noCFO1
        [0.193, 12, 2], ... % Ant2_SCS15_FA2_NCS46_noCFO1
        [0.192, 12, 1], ... % Ant2_SCS15_FA2_NCS69_noCFO1
        [0.119, 12, 2], ... % Ant4_SCS15_FA2_NCS0_noCFO1
        [0.402, 12, 0], ... % Ant4_SCS15_FA2_NCS2_noCFO1
        [0.363, 12, 2], ... % Ant4_SCS15_FA2_NCS4_noCFO1
        [0.326, 12, 2], ... % Ant4_SCS15_FA2_NCS6_noCFO1
        [0.304, 12, 2], ... % Ant4_SCS15_FA2_NCS8_noCFO1
        [0.273, 12, 2], ... % Ant4_SCS15_FA2_NCS10_noCFO1
        [0.248, 12, 1], ... % Ant4_SCS15_FA2_NCS12_noCFO1
        [0.243, 12, 2], ... % Ant4_SCS15_FA2_NCS13_noCFO1
        [0.224, 12, 1], ... % Ant4_SCS15_FA2_NCS15_noCFO1
        [0.206, 12, 2], ... % Ant4_SCS15_FA2_NCS17_noCFO1
        [0.195, 12, 2], ... % Ant4_SCS15_FA2_NCS19_noCFO1
        [0.172, 12, 2], ... % Ant4_SCS15_FA2_NCS23_noCFO1
        [0.154, 12, 1], ... % Ant4_SCS15_FA2_NCS27_noCFO1
        [0.131, 12, 1], ... % Ant4_SCS15_FA2_NCS34_noCFO1
        [0.118, 12, 2], ... % Ant4_SCS15_FA2_NCS46_noCFO1
        [0.119, 12, 2], ... % Ant4_SCS15_FA2_NCS69_noCFO1
        [0.352, 12, 2], ... % Ant1_SCS30_FA2_NCS0_noCFO1
        [1.000, 12, 0], ... % Ant1_SCS30_FA2_NCS2_noCFO1
        [1.000, 12, 0], ... % Ant1_SCS30_FA2_NCS4_noCFO1
        [1.000, 12, 0], ... % Ant1_SCS30_FA2_NCS6_noCFO1
        [0.993, 12, 1], ... % Ant1_SCS30_FA2_NCS8_noCFO1
        [0.863, 12, 1], ... % Ant1_SCS30_FA2_NCS10_noCFO1
        [0.786, 12, 1], ... % Ant1_SCS30_FA2_NCS12_noCFO1
        [0.776, 12, 1], ... % Ant1_SCS30_FA2_NCS13_noCFO1
        [0.699, 12, 1], ... % Ant1_SCS30_FA2_NCS15_noCFO1
        [0.633, 12, 1], ... % Ant1_SCS30_FA2_NCS17_noCFO1
        [0.607, 12, 1], ... % Ant1_SCS30_FA2_NCS19_noCFO1
        [0.518, 12, 1], ... % Ant1_SCS30_FA2_NCS23_noCFO1
        [0.464, 12, 1], ... % Ant1_SCS30_FA2_NCS27_noCFO1
        [0.392, 12, 1], ... % Ant1_SCS30_FA2_NCS34_noCFO1
        [0.349, 12, 1], ... % Ant1_SCS30_FA2_NCS46_noCFO1
        [0.353, 12, 2], ... % Ant1_SCS30_FA2_NCS69_noCFO1
        [0.194, 12, 2], ... % Ant2_SCS30_FA2_NCS0_noCFO1
        [0.694, 12, 0], ... % Ant2_SCS30_FA2_NCS2_noCFO1
        [0.611, 12, 1], ... % Ant2_SCS30_FA2_NCS4_noCFO1
        [0.550, 12, 1], ... % Ant2_SCS30_FA2_NCS6_noCFO1
        [0.510, 12, 1], ... % Ant2_SCS30_FA2_NCS8_noCFO1
        [0.452, 12, 1], ... % Ant2_SCS30_FA2_NCS10_noCFO1
        [0.411, 12, 1], ... % Ant2_SCS30_FA2_NCS12_noCFO1
        [0.400, 12, 1], ... % Ant2_SCS30_FA2_NCS13_noCFO1
        [0.367, 12, 1], ... % Ant2_SCS30_FA2_NCS15_noCFO1
        [0.340, 12, 1], ... % Ant2_SCS30_FA2_NCS17_noCFO1
        [0.323, 12, 1], ... % Ant2_SCS30_FA2_NCS19_noCFO1
        [0.282, 12, 2], ... % Ant2_SCS30_FA2_NCS23_noCFO1
        [0.256, 12, 2], ... % Ant2_SCS30_FA2_NCS27_noCFO1
        [0.212, 12, 1], ... % Ant2_SCS30_FA2_NCS34_noCFO1
        [0.193, 12, 1], ... % Ant2_SCS30_FA2_NCS46_noCFO1
        [0.193, 12, 2], ... % Ant2_SCS30_FA2_NCS69_noCFO1
        [0.118, 12, 1], ... % Ant4_SCS30_FA2_NCS0_noCFO1
        [0.404, 12, 0], ... % Ant4_SCS30_FA2_NCS2_noCFO1
        [0.362, 12, 1], ... % Ant4_SCS30_FA2_NCS4_noCFO1
        [0.328, 12, 1], ... % Ant4_SCS30_FA2_NCS6_noCFO1
        [0.301, 12, 1], ... % Ant4_SCS30_FA2_NCS8_noCFO1
        [0.272, 12, 2], ... % Ant4_SCS30_FA2_NCS10_noCFO1
        [0.247, 12, 2], ... % Ant4_SCS30_FA2_NCS12_noCFO1
        [0.242, 12, 2], ... % Ant4_SCS30_FA2_NCS13_noCFO1
        [0.222, 12, 2], ... % Ant4_SCS30_FA2_NCS15_noCFO1
        [0.205, 12, 1], ... % Ant4_SCS30_FA2_NCS17_noCFO1
        [0.195, 12, 1], ... % Ant4_SCS30_FA2_NCS19_noCFO1
        [0.170, 12, 1], ... % Ant4_SCS30_FA2_NCS23_noCFO1
        [0.155, 12, 2], ... % Ant4_SCS30_FA2_NCS27_noCFO1
        [0.131, 12, 1], ... % Ant4_SCS30_FA2_NCS34_noCFO1
        [0.119, 12, 2], ... % Ant4_SCS30_FA2_NCS46_noCFO1
        [0.119, 12, 2], ... % Ant4_SCS30_FA2_NCS69_noCFO1
        [0.234, 12, 2], ... % Ant1_SCS15_FB4_NCS0_noCFO1
        [1.000, 12, 0], ... % Ant1_SCS15_FB4_NCS2_noCFO1
        [1.000, 12, 0], ... % Ant1_SCS15_FB4_NCS4_noCFO1
        [1.000, 12, 1], ... % Ant1_SCS15_FB4_NCS6_noCFO1
        [0.995, 12, 1], ... % Ant1_SCS15_FB4_NCS8_noCFO1
        [0.876, 12, 1], ... % Ant1_SCS15_FB4_NCS10_noCFO1
        [0.789, 12, 1], ... % Ant1_SCS15_FB4_NCS12_noCFO1
        [0.763, 12, 1], ... % Ant1_SCS15_FB4_NCS13_noCFO1
        [0.707, 12, 1], ... % Ant1_SCS15_FB4_NCS15_noCFO1
        [0.646, 12, 1], ... % Ant1_SCS15_FB4_NCS17_noCFO1
        [0.603, 12, 1], ... % Ant1_SCS15_FB4_NCS19_noCFO1
        [0.517, 12, 1], ... % Ant1_SCS15_FB4_NCS23_noCFO1
        [0.465, 12, 1], ... % Ant1_SCS15_FB4_NCS27_noCFO1
        [0.388, 12, 1], ... % Ant1_SCS15_FB4_NCS34_noCFO1
        [0.304, 12, 2], ... % Ant1_SCS15_FB4_NCS46_noCFO1
        [0.232, 12, 2], ... % Ant1_SCS15_FB4_NCS69_noCFO1
        [0.134, 12, 2], ... % Ant2_SCS15_FB4_NCS0_noCFO1
        [0.687, 12, 0], ... % Ant2_SCS15_FB4_NCS2_noCFO1
        [0.616, 12, 1], ... % Ant2_SCS15_FB4_NCS4_noCFO1
        [0.553, 12, 1], ... % Ant2_SCS15_FB4_NCS6_noCFO1
        [0.510, 12, 1], ... % Ant2_SCS15_FB4_NCS8_noCFO1
        [0.456, 12, 1], ... % Ant2_SCS15_FB4_NCS10_noCFO1
        [0.408, 12, 1], ... % Ant2_SCS15_FB4_NCS12_noCFO1
        [0.402, 12, 1], ... % Ant2_SCS15_FB4_NCS13_noCFO1
        [0.370, 12, 2], ... % Ant2_SCS15_FB4_NCS15_noCFO1
        [0.348, 12, 2], ... % Ant2_SCS15_FB4_NCS17_noCFO1
        [0.326, 12, 2], ... % Ant2_SCS15_FB4_NCS19_noCFO1
        [0.283, 12, 1], ... % Ant2_SCS15_FB4_NCS23_noCFO1
        [0.252, 12, 1], ... % Ant2_SCS15_FB4_NCS27_noCFO1
        [0.217, 12, 2], ... % Ant2_SCS15_FB4_NCS34_noCFO1
        [0.173, 12, 2], ... % Ant2_SCS15_FB4_NCS46_noCFO1
        [0.133, 12, 2], ... % Ant2_SCS15_FB4_NCS69_noCFO1
        [0.080, 12, 1], ... % Ant4_SCS15_FB4_NCS0_noCFO1
        [0.401, 12, 0], ... % Ant4_SCS15_FB4_NCS2_noCFO1
        [0.360, 12, 1], ... % Ant4_SCS15_FB4_NCS4_noCFO1
        [0.324, 12, 1], ... % Ant4_SCS15_FB4_NCS6_noCFO1
        [0.298, 12, 1], ... % Ant4_SCS15_FB4_NCS8_noCFO1
        [0.270, 12, 2], ... % Ant4_SCS15_FB4_NCS10_noCFO1
        [0.246, 12, 2], ... % Ant4_SCS15_FB4_NCS12_noCFO1
        [0.242, 12, 2], ... % Ant4_SCS15_FB4_NCS13_noCFO1
        [0.223, 12, 2], ... % Ant4_SCS15_FB4_NCS15_noCFO1
        [0.205, 12, 2], ... % Ant4_SCS15_FB4_NCS17_noCFO1
        [0.193, 12, 1], ... % Ant4_SCS15_FB4_NCS19_noCFO1
        [0.171, 12, 2], ... % Ant4_SCS15_FB4_NCS23_noCFO1
        [0.153, 12, 1], ... % Ant4_SCS15_FB4_NCS27_noCFO1
        [0.130, 12, 1], ... % Ant4_SCS15_FB4_NCS34_noCFO1
        [0.104, 12, 1], ... % Ant4_SCS15_FB4_NCS46_noCFO1
        [0.080, 12, 1], ... % Ant4_SCS15_FB4_NCS69_noCFO1
        [0.229, 12, 1], ... % Ant1_SCS30_FB4_NCS0_noCFO1
        [1.000, 12, 0], ... % Ant1_SCS30_FB4_NCS2_noCFO1
        [1.000, 12, 0], ... % Ant1_SCS30_FB4_NCS4_noCFO1
        [1.000, 12, 1], ... % Ant1_SCS30_FB4_NCS6_noCFO1
        [0.986, 12, 1], ... % Ant1_SCS30_FB4_NCS8_noCFO1
        [0.883, 12, 1], ... % Ant1_SCS30_FB4_NCS10_noCFO1
        [0.783, 12, 1], ... % Ant1_SCS30_FB4_NCS12_noCFO1
        [0.770, 12, 1], ... % Ant1_SCS30_FB4_NCS13_noCFO1
        [0.700, 12, 1], ... % Ant1_SCS30_FB4_NCS15_noCFO1
        [0.637, 12, 1], ... % Ant1_SCS30_FB4_NCS17_noCFO1
        [0.599, 12, 1], ... % Ant1_SCS30_FB4_NCS19_noCFO1
        [0.516, 12, 1], ... % Ant1_SCS30_FB4_NCS23_noCFO1
        [0.464, 12, 1], ... % Ant1_SCS30_FB4_NCS27_noCFO1
        [0.385, 12, 1], ... % Ant1_SCS30_FB4_NCS34_noCFO1
        [0.304, 12, 1], ... % Ant1_SCS30_FB4_NCS46_noCFO1
        [0.232, 12, 2], ... % Ant1_SCS30_FB4_NCS69_noCFO1
        [0.131, 12, 1], ... % Ant2_SCS30_FB4_NCS0_noCFO1
        [0.677, 12, 0], ... % Ant2_SCS30_FB4_NCS2_noCFO1
        [0.622, 12, 1], ... % Ant2_SCS30_FB4_NCS4_noCFO1
        [0.553, 12, 1], ... % Ant2_SCS30_FB4_NCS6_noCFO1
        [0.511, 12, 1], ... % Ant2_SCS30_FB4_NCS8_noCFO1
        [0.458, 12, 1], ... % Ant2_SCS30_FB4_NCS10_noCFO1
        [0.414, 12, 1], ... % Ant2_SCS30_FB4_NCS12_noCFO1
        [0.409, 12, 1], ... % Ant2_SCS30_FB4_NCS13_noCFO1
        [0.374, 12, 2], ... % Ant2_SCS30_FB4_NCS15_noCFO1
        [0.345, 12, 2], ... % Ant2_SCS30_FB4_NCS17_noCFO1
        [0.325, 12, 2], ... % Ant2_SCS30_FB4_NCS19_noCFO1
        [0.283, 12, 1], ... % Ant2_SCS30_FB4_NCS23_noCFO1
        [0.255, 12, 2], ... % Ant2_SCS30_FB4_NCS27_noCFO1
        [0.213, 12, 1], ... % Ant2_SCS30_FB4_NCS34_noCFO1
        [0.171, 12, 2], ... % Ant2_SCS30_FB4_NCS46_noCFO1
        [0.132, 12, 2], ... % Ant2_SCS30_FB4_NCS69_noCFO1
        [0.081, 12, 2], ... % Ant4_SCS30_FB4_NCS0_noCFO1
        [0.404, 12, 0], ... % Ant4_SCS30_FB4_NCS2_noCFO1
        [0.363, 12, 1], ... % Ant4_SCS30_FB4_NCS4_noCFO1
        [0.322, 12, 1], ... % Ant4_SCS30_FB4_NCS6_noCFO1
        [0.298, 12, 1], ... % Ant4_SCS30_FB4_NCS8_noCFO1
        [0.268, 12, 1], ... % Ant4_SCS30_FB4_NCS10_noCFO1
        [0.246, 12, 1], ... % Ant4_SCS30_FB4_NCS12_noCFO1
        [0.241, 12, 1], ... % Ant4_SCS30_FB4_NCS13_noCFO1
        [0.219, 12, 1], ... % Ant4_SCS30_FB4_NCS15_noCFO1
        [0.205, 12, 1], ... % Ant4_SCS30_FB4_NCS17_noCFO1
        [0.197, 12, 2], ... % Ant4_SCS30_FB4_NCS19_noCFO1
        [0.171, 12, 2], ... % Ant4_SCS30_FB4_NCS23_noCFO1
        [0.155, 12, 2], ... % Ant4_SCS30_FB4_NCS27_noCFO1
        [0.131, 12, 2], ... % Ant4_SCS30_FB4_NCS34_noCFO1
        [0.105, 12, 2], ... % Ant4_SCS30_FB4_NCS46_noCFO1
        [0.081, 12, 2], ... % Ant4_SCS30_FB4_NCS69_noCFO1
        };
     d = dictionary(Configurations, ThresholdsMargins);

     if ismember(prach.Format, {'0', '1', '2', '3'})
         % For long PRACH formats, the PUSCH SCS is not important, set it to 15.
         scs = 15;
     end
     NCS = getNCS(prach);
     confString = sprintf("Ant%d_SCS%d_F%s_NCS%d_noCFO%d", nAntennas, scs, prach.Format, NCS, ignoreCFO);

     try
         tt = cell2mat(d(confString));
         winMargin = tt(2);
         threshold = tt(1);
         goodnessLevel = tt(3);

         if (goodnessLevel == 0)
             warning('srsran_matlab:srsPRACHdetector', ...
                 'The PRACH detector is not working well with this configuration.');
         elseif (goodnessLevel == 1)
             warning('srsran_matlab:srsPRACHdetector', ...
                 'The PRACH detector may be suboptimal with this configuration.');
         end
     catch
         warning('srsran_matlab:srsPRACHdetector', ...
             'Using a non-calibrated configuration with a suboptimal detection threshold.');
         if ismember(prach.Format, {'0', '1', '2', '3'})
             winMargin = 5;
             threshold = 0.1;
         else
             winMargin = 12;
             threshold = 0.3;
         end
     end
end
